# Declaration of the mod key
set $mod Mod4
set $alt Mod1

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:monospace 8

# use these keys for focus, movement, and resize directions when reaching for
# the arrows is not convenient
set $up     Up
set $down   Down
set $left   Left
set $right  Right

# use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

################################################################################
###                                 Shortcuts                                ###
################################################################################

# start a terminal
bindsym $mod+Return exec st

# kill focused window
bindsym $mod+q  kill
bindsym $alt+F4 kill

# start dmenu (a program launcher)
bindsym $mod+Shift+d  exec --no-startup-id j4-dmenu-desktop
bindsym $mod+d        exec "rofi -combi-modi window,drun -show combi -mohh combi"

# change focus
bindsym $mod+$left        focus left
bindsym $mod+$down        focus down
bindsym $mod+$up          focus up
bindsym $mod+$right       focus right
# move focused window
bindsym $mod+Shift+$left  move left
bindsym $mod+Shift+$down  move down
bindsym $mod+Shift+$up    move up
bindsym $mod+Shift+$right move right

# split in horizontal orientation
bindsym $mod+h split h
# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# toggle tiling / floating
bindsym $mod+Shift+space  floating toggle
# change focus between tiling / floating windows
bindsym $mod+space        focus mode_toggle

# Scratchpad
bindsym $mod+Shift+s  move scratchpad
bindsym $mod+s        scratchpad show

# switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10

# move to previous or next workspace
bindsym $mod+Tab        workspace next
bindsym $mod+Shift+Tab  workspace previous

# reload the configuration file
bindsym $mod+Shift+c  reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r  restart
# exit i3 (logs you out of your X session)
bindsym $mod+Shift+e  exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 
'i3-msg exit'"

# resize window (you can also use the mouse for that)
mode "resize" {
        bindsym $right      resize grow width 20 px or 10 ppt
        bindsym $left       resize shrink width 10 px or 5 ppt
        bindsym $down       resize grow height 10 px or 5 ppt
        bindsym $up         resize shrink height 10 px or 5 ppt
        bindsym Return mode "default"
        bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

mouse_warping none

# Keyboard layout
bindsym $mod+$alt+k       exec setxkbmap fr bepo
bindsym $mod+$alt+Shift+k exec setxkbmap fr
bindsym $mod+$alt+Ctrl+k  exec setxkbmap us

# bindings for MS Natural Ergonomic Keyboard 4000 ##############################
bindsym XF86Launch5               workspace 2;  exec emacs
bindsym $mod+e                    workspace 2;  exec emacs
bindsym XF86Launch6               workspace 3;  exec chromium
bindsym $mod+c                    workspace 3;  exec chromium
bindsym XF86HomePage              workspace 3;  exec chromium https://labs.phundrak.fr
bindsym XF86Search                workspace 3;  exec chromium https://www.google.com
bindsym XF86Launch9               workspace 4;  exec nemo
bindsym $mod+n                    workspace 4;  exec nemo
bindsym XF86Launch8               workspace 5;  exec emacs --eval "(gnus)"
bindsym XF86Mail                  workspace 5;  exec emacs --eval "(gnus)"
bindsym $mod+m                    workspace 5;  exec emacs --eval "(gnus)"
bindsym XF86Launch7               workspace 10; exec discord-canary
bindsym Ctrl+Shift+d              workspace 10; exec discord-canary
bindsym XF86AudioMute                           exec amixer -D pulse set Master 1+ toggle
bindsym XF86AudioRaiseVolume                    exec amixer -D pulse -q set Master 5%+ unmute
bindsym XF86AudioLowerVolume                    exec amixer -D pulse -q set Master 5%- unmute
bindsym XF86Calculator                          exec /usr/bin/gnome-calculator
#bindsym XF86Favourites
#bindsym Help
#bindsym Undo
#bindsym Redo
#bindsym XF86New
#bindsym SunOpen
#bindsym XF86Close
#bindsym XF86Reply
#bindsym XF86MailForward
#bindsym XF86Send
#bindsym XF86Save

bindsym $mod+F3 exec arandr
bindsym $mod+F2 exec systemctl restart NetworkManager

# Brightness keyboard shortcuts
bindsym XF86MonBrightnessUp   exec light -A 5
bindsym XF86MonBrightnessDown exec light -U 5

# Wal
bindsym Ctrl+$mod+w exec "wal -i ~/.config/Wallpapers -o wal-set"

# Take a screenshot
bindsym Print             exec --no-startup-id scrot
bindsym Shift+Print       exec --no-startup-id scrot -d 3
bindsym Ctrl+Print        exec --no-startup-id scrot -s

# Lock screen
set     $lockscreen   lock -t 'Lucien Cartier-Tilet (Phuntsok Drak-pa), +33 (0)6 83 90 56 89'
bindsym $mod+l        exec "$lockscreen"
bindsym $mod+$alt+h   exec "$lockscreen && systemctl suspend"
bindsym $mod+Shift+h  exec "$lockscreen && systemctl hibernate"

# Music shortcuts
bindsym $alt+XF86AudioRaiseVolume exec mpc next
bindsym $mod+Next                 exec mpc next
bindsym $alt+XF86AudioLowerVolume exec mpc prev
bindsym $mod+Prior                exec mpc prev
bindsym XF86AudioPlay             exec mpc toggle
bindsym $mod+p                    exec mpc toggle
bindsym $mod+$alt+p               exec mpc stop
bindsym $alt+XF86AudioPlay        exec mpc stop
bindsym $mod+Shift+n              exec st ncmpcpp -q
bindsym $mod+Shift+v              exec st ncmpcpp -qs visualizer    

################################################################################
#                               i3-gaps settings                               #
################################################################################

smart_gaps          on
gaps                inner 20
gaps                outer -10
Focus_follows_mouse off

# Change gaps size
bindsym $mod+g            gaps inner current plus 5
bindsym $mod+Shift+g      gaps inner current minus 5
bindsym $mod+Ctrl+g       gaps outer current plus 5
bindsym $mod+Ctrl+Shift+g gaps outer current minus 5
bindsym $mod+$alt+g       gaps inner all set 20; gaps outer all set -10

new_window none
smart_borders on

################################################################################
#                                Modules startup                               #
################################################################################
exec_always ~/dotfiles/enable_thouch.sh
exec_always --no-startup-id i3-battery-popup -N -t 2m
exec_always wal -i "$(< "${HOME}/.cache/wal/wal")"
exec "xrdb $HOME/.Xresources"
exec --no-startup-id xfce4-power-manager
exec --no-startup-id compton -F --opengl --config ~/.config/compton.conf -e 1
exec --no-startup-id numlockx on
exec_always --no-startup-id ~/.config/polybar/launch.sh
exec_always redshift-gtk
exec_always mpd
exec_always mpc stop

################################################################################
#                          Set colors from Xresources                          #
################################################################################
# Change 'color7' and 'color2' to whatever colors you want i3 to use
# from the generated scheme.
# NOTE: The '#f0f0f0' in the lines below is the color i3 will use if
# it fails to get colors from Xresources for some reason.
set_from_resource $fg i3wm.color7 #f0f0f0
set_from_resource $bg i3wm.color2 #f0f0f0

# class                 border  backgr. text indicator child_border
client.focused          $bg     $bg     $fg  $bg       $bg
client.focused_inactive $bg     $bg     $fg  $bg       $bg
client.unfocused        $bg     $bg     $fg  $bg       $bg
client.urgent           $bg     $bg     $fg  $bg       $bg
client.placeholder      $bg     $bg     $fg  $bg       $bg

# client.background       $bg
